mapping = aes(x = SMRIN)) +
geom_density()
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_density() +
xlab("Tissue integrity number")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram() +
xlab("Tissue integrity number")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 25) +
xlab("Tissue integrity number")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 25) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 30) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 50) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 60) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 70) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 80) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 75) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 70) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 72) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram(bins = 71) +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram() +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = RIN)) +
geom_histogram()
?facet_grid
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram() +
xlab("Tissue integrity number") +
ylab("Number of samples") +
facet_grid(rows = SMTSD)
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_histogram() +
xlab("Tissue integrity number") +
ylab("Number of samples") +
facet_grid(rows = vars(SMTSD))
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_histogram() #+
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_point()
#Q5
#SMRIN is the tissue integrity number, ranging from least (10) to most (1) degraded
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_boxplot() +
xlab("Tissue integrity number") +
ylab("Number of samples")
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_boxplot() +
?geom_boxplot
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMRIN)) +
geom_boxplot() +
?geom_boxplot()
?geom_boxplot()
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD)) +
geom_boxplot()
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot()
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + #rotate the x-axis text
?geom_boxplot()
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  #rotate the x-axis text
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +  #rotate the x-axis text
xlab("Tissue type") +
ylab("Tissue integrity number")
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +  #rotate the x-axis text
xlab("Tissue type") +
ylab("Tissue integrity number") +
labs(title = "Tissue integrity number by tissue type")
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_violin() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +  #rotate the x-axis text
xlab("Tissue type") +
ylab("Tissue integrity number") +
labs(title = "Tissue integrity number by tissue type")
#Q6
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMRIN)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +  #rotate the x-axis text
xlab("Tissue type") +
ylab("Tissue integrity number") +
labs(title = "Tissue integrity number by tissue type")
#Q7
#Genes detected is SMGNSDTC
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSD, y = SMGNSDTC)) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +  #rotate the x-axis text
xlab("Tissue type") +
ylab("Genes detected") +
labs(title = "Genes detected by tissue type")
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point() +
?geom_boxplot()
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point()
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point(size = 0.5 )
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5)
?facet_wrap()
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD))
facet_wrap(vars(SMTSD)) +
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm")
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMGNSDTC, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm")
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm")
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
?facet_wrap()
#Q8
#SMTSISCH is total ischemic time
#SMRIN is tissue integrity number
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") + scale_fill_discrete(name = "New Legend Title")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
guides(fill = guide_legend(title = "Title"))
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR),guides(fill = guide_legend(title = "Title"))) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR), guides(fill = guide_legend(title = "Title"))) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
?aes
#Q1
library(viridis)
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
names(RNA_seq_only)
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR, alpha = SMEXNCRT, shape = SME2MPRT)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
names(RNA_seq_only)
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR, alpha = SMEXNCRT)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN, alpha = SMEXNCRT)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN, alpha = SMEXNCRT)) +
geom_point(size = 0.5,  aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK") +
theme(legend.position = "none")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "OK") +
theme_minimal()
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "Autolysis score")
#Q9
ggplot(data = RNA_seq_only,
mapping = aes(x = SMTSISCH, y = SMRIN)) +
geom_point(size = 0.5, alpha = 0.5, aes(color = SMATSSCR)) +
facet_wrap(vars(SMTSD)) +
geom_smooth(method = "lm") +
xlab("Ischemic time (minutes)") +
ylab("RNA integrity number") +
labs(color = "Autolysis score") +
scale_fill_viridis()
?aes
#Exercise 2
library("tidyverse") #load tidyverse
#Exercise 3
df <- read_tsv("~/Data/GTEx/GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt") #load text file and assign it to the variable df
df <- df %>%
mutate( SUBJECT=str_extract( SAMPID, "[^-]+-[^-]+" ), .before=1 )
head(df)
#Exercise 4
df %>%
group_by(SUBJECT) %>%  #group by subject
summarise(num_of_samples = n()) %>% #produce a new data frame that only includes grouping variables
#and create the variable num_of_samples corresponding to the size of the current group
#which in this case is instances of each SUBJECT
arrange(desc(num_of_samples))       #arrange num_of_samples descending
df %>%
group_by(SUBJECT) %>%
summarise(num_of_samples = n()) %>%
arrange((num_of_samples))
#Exercise 5
df %>%
group_by(SMTSD) %>%
summarise(num_of_samples = n()) %>%
arrange(desc(num_of_samples))
df %>%
group_by(SMTSD) %>%
summarise(num_of_samples = n()) %>%
arrange((num_of_samples))
#Exercise 6
df_npj8 <- subset(df, SUBJECT == "GTEX-NPJ8")
df_npj8_dplyr <- df %>%
filter(SUBJECT == "GTEX-NPJ8")
df_npj8 %>%
group_by(SMTSD) %>%
summarise(num_of_samples = n()) %>%
arrange(desc(num_of_samples))
View(df_npj8)
View(df_npj8_dplyr)
df_npj8_Whole_Blood <- df_npj8 %>%
filter(SMTSD == "Whole Blood")
View(df_npj8_Whole_Blood)
#Exercise 7
df_autolysis <- df %>%
filter( !is.na(SMATSSCR) )
?mutate()
df_autolysis %>%
mutate() %>%
filter(SMASSCR == 0)
df_autolysis %>%
mutate() %>%
filter(SMATSSCR == 0)
df_autolysis_0 <- df_autolysis %>%
mutate() %>%
filter(SMATSSCR == 0)
View(df_autolysis_0)
glimpse(df_autolysis_0)
?group_by
df_autolysis_0 <- df_autolysis %>%
mutate() %>%
group_by(SUBJECT) %>%
?tidyr::mean
df_autolysis_0 <- df_autolysis %>%
mutate() %>%
group_by(SUBJECT) %>%
summarise(mean_SMATSSCR = mean(SMATSSCR))
View(df_autolysis_0)
df_autolysis_0 %>%
filter(mean_SMATSSCR == 0)
df_autolysis <- df_autolysis %>% #create a new tibble using these operations
mutate() %>% #make a new column
group_by(SUBJECT) %>% #group by SUBJECT
summarise(mean_SMATSSCR = mean(SMATSSCR)) #calculate the mean SMATSSCR by subject
df_autolysis %>% #filter to only those subjects with a SMATSSCR mean of 0
filter(mean_SMATSSCR == 0)
ggplot(df_autolysis,
aes(x = mean_SMATSSCR))+
geom_histogram()
